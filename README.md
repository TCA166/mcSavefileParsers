# mcSavefileParsers

Multiple programs for Minecraft savefile data extraction and 3D model generation based on savefiles.  

## Getting started

In order to get started either download the parts of the precompiled release that apply to your system or compile the source code yourself. For that compile.sh script was created and for crosscompilation for Windows winCompile.sh was created.

## regionFileReader

This program extracts all the chunks in the given region file into nbt files that will be created in the provided directory.

```Bash
regionFileReader <path to region file> <output directory>
```

## chunkExtractor

This program extracts only a single chunk with the given chunk coordinates into an nbt file.

```Bash
chunkExtractor <path to region directory> <x> <z>
```

## modelGenerator

This program generates a waveform(.obj) 3d model file from an nbt file containing data about a specific chunk. Ideally this nbt file will be extracted using one of the tools above. It's very customizable to the point where you can render the model using different texture packs and models.

```Bash
modelGenerator <path to nbt file> <args>
```

The program accepts the following additional arguments:

- -l $y+ $y- :limits the result model to the given vertical range
- -f :disables face culling
- -h :displays help
- -s $s :changes the block side in the result side to the given s argument
- -m $filename :sets the given filename as the source mtl file
- -o $filename :sets the given filename as the source special objects file

### Mtl format

The generator if provided with the -m flag followed by the mtl file filepath will use the provided file as a material source and generate the obj file to support mtl materials. Blocks of minecraft:dirt will use a mtl material called dirt and so on. Feel free to create your own mtl file or use the mtl Gen to create one quickly.

### Obj format

So in order to handle non cube blocks the generator needs an obj file defining models for those "special" blocks.
If that file isn't provided the generator will simply assume everything is a cube.
In order for the special obj file to get interpreted properly the vertex coordinates in each object must be relative to the center of the object.

### Limitations

Unfortunately there are still some limitations to the generator. Most notably entities are ignored. So everything which is not internally in Minecraft a block will not be in the end result. Also for now the generator doesn't fully support blocks that have different faces. That will come in the future.

## mtlGen

Generation of specific mtl files for the modelGenerator to use is rather tricky. Thus I also made a python script that generates valid mtl files from texture packs.

```Bash
python3 mtlGen.py <path to /assets/minecraft/textures/block folder of a texture pack> <args>
```

The script accepts the following additional arguments:

- -s :Generates a simplified mtl file that doesn't use textures, but solid colors generated by averaging out RGBA values of all pixels
- -t :Causes all textures with _top in name to be generated without it
- -c :Enables green color correction to correct for the fact most vegetation textures are stored in greyscale

## cNBT

For parsing of the nbt files I have chosen to use the [cNBT](https://github.com/chmod222/cNBT/tree/master) library. These files are located in the appropriately named folder and need to be compiled using the script next to them to make the modelGenerator compile properly.

## API

Most of the code has been organized into three "libraries".
regionParser handles nbt extraction from region files, chunkParser extracts data from chunk nbts and finally model handles generating models from chunk data.
Feel free to use these as libraries in your projects just make sure to read the license before you do so.
The documentation for functions in these libraries should be mainly in header files, and I will gladly expand it should there be a need so just let me know.

## License

[![CCimg](https://i.creativecommons.org/l/by/4.0/88x31.png)](http://creativecommons.org/licenses/by/4.0/)  
This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/).  
